<!DOCTYPE html>
<html>
<head>
    <title>Dashboard - Attendance Management System</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
    <div class="dashboard-container">
        <header class="header">
            <h2>Attendance Management System</h2>
            <button id="logoutButton">Logout</button>
        </header>
        <div class="content">
            <div class="card">
                <h3>Add New Card</h3>
                <form id="addCardForm">
                    <div class="input-group">
                        <label for="uid">UID</label>
                        <input type="text" id="uid" placeholder="UID" required>
                    </div>
                    <div class="input-group">
                        <label for="name">Name</label>
                        <input type="text" id="name" placeholder="Name" required>
                    </div>
                    <div class="input-group">
                        <label for="position">Position</label>
                        <select id="position" required>
                            <option value="student">Student</option>
                            <option value="staff">Staff</option>
                            <option value="visitor">Visitor</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" placeholder="Email" required>
                    </div>
                    <div class="input-group">
                        <label for="classNumber">Class Number</label>
                        <input type="text" id="classNumber" placeholder="Class Number">
                    </div>
                    <div class="input-group">
                        <label for="classCode">Class Code</label>
                        <input type="text" id="classCode" placeholder="Class Code">
                    </div>
                    <button type="submit">Add Card</button>
                </form>
            </div>
            <div class="card">
                <h3>Search Card</h3>
                <form id="searchForm">
                    <div class="input-group">
                        <input type="text" id="searchQuery" placeholder="Search by UID, Name, or Email" required>
                    </div>
                    <button type="submit">Search</button>
                </form>
                <div id="searchResult" class="search-result"></div>
            </div>
            <div class="card">
                <h3>All Cards</h3>
                <div class="table-container">
                    <table id="cardsTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>ID</th>
                                <th>Email</th>
                                <th>Position</th>
                                <th>Class Number</th>
                                <th>Class Code</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="card">
                <h3>Search Logs</h3>
                <form id="logSearchForm">
                    <div class="input-group">
                        <input type="text" id="logSearchQuery" placeholder="Search logs by UID, Name, or Email" required>
                    </div>
                    <button type="submit">Search Logs</button>
                </form>
                <div id="logSearchResult" class="log-search-result"></div>
            </div>
            <div class="card">
                <h3>Scan Logs</h3>
                <div class="table-container">
                    <table id="logsTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>ID</th>
                                <th>Email</th>
                                <th>Position</th>
                                <th>Class Number</th>
                                <th>Class Code</th>
                                <th>Timestamp</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <button id="clearLogsButton">Clear Logs</button>
            </div>
            <div class="card">
                <h3>Statistics</h3>
                <canvas id="logsChart" width="400" height="200"></canvas>
                <div id="statistics">
                    <p><strong>Number of Cards:</strong> <span id="totalCards"></span></p>
                    <p><strong>Number of Scans in the Last 7 Days:</strong> <span id="scansLast7Days"></span></p>
                    <p><strong>Number of Cards Not Scanned in the Last 7 Days:</strong> <span id="cardsNotScanned"></span></p>
                </div>
            </div>
            <div class="card">
                <h3>Export Logs</h3>
                <button id="exportLogsButton">Export Logs as CSV</button>
            </div>
            <div class="card">
                <h3>Notifications</h3>
                <div class="table-container">
                    <table id="notificationsTable">
                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>Message</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <button id="clearNotificationsButton">Clear Notifications</button>
            </div>
            <div class="card">
                <h3>Set Check-In Time</h3>
                <form id="checkInTimeForm">
                    <div class="input-group">
                        <label for="checkInTime">Check-In Time (HH:MM):</label>
                        <input type="time" id="checkInTime" required>
                    </div>
                    <button type="submit">Set Time</button>
                </form>
                <p><strong>Current Check-In Time:</strong> <span id="currentCheckInTime"></span></p>
            </div>
        </div>
    </div>

    <!-- Notification Modal -->
    <div id="notificationModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <p id="notificationMessage"></p>
        </div>
    </div>

    <!-- Edit Card Modal -->
    <div id="editCardModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>Edit Card</h3>
            <form id="editCardForm">
                <div class="input-group">
                    <label for="editName">Name</label>
                    <input type="text" id="editName" placeholder="Name" required>
                </div>
                <div class="input-group">
                    <label for="editEmail">Email</label>
                    <input type="email" id="editEmail" placeholder="Email" required>
                </div>
                <button type="submit">Save Changes</button>
            </form>
        </div>
    </div>

    <script type="module" src="dashboard.js"></script>
</body>
</html>
